{% load template_tags %}
{% if case.litigants.all %}
<h3 class="card-header text-center bg-grey">Litigants</h3>
    <div class="card-body">
        <div class="accordion">
            {% for litigant in case.litigants.all %}
                    <div class="card">
                        <div class="card-header">
                            <div class="row">

                                <div class="col-4"><h6 style="color:blue"><a href="{% url 'person:detail' litigant.person.id %}">{{ litigant.person.full_name }}</a></h6></div>
                                <div class="col-4 text-center" id="litigant_{{ litigant.person.full_name }}" data-toggle="collapse" data-target="#{{ litigant.id }}_collapse" aria-expanded="true" aria-controls="{{ litigant.id }}_collapse" style="color:darkgray"><u>(click here to see details)</u></div>
                                <div class="col-4"><h6 class="float-right" style="color:blue">Role: {{ litigant.role.role }}</h6></div>
                            </div>
                        </div>
                        <div class="collapse" id="{{ litigant.id }}_collapse" aria-labelledby="litigant_{{ litigant.person.full_name }}" data-parent="#accordion">
                            <div class="card-body">

                                {% if litigant.ad_proximum or litigant.attached or litigant.bail or litigant.distrained %}
                                    <table class="table table-bordered" id="standard_table">
                                        <thead>
                                            <th>Ad. Prox</th>
                                            <th>Attached</th>
                                            <th>Bailed</th>
                                            <th>Distrained</th>
                                        </thead>
                                        <tbody>
                                            <tr>
                                            {% if litigant.ad_proximum %}
                                                <td class="text-center"><b>√</b></td>
                                            {% endif %}
                                            {% if litigant.attached %}
                                                <td class="text-center"><b>√</b></td>
                                            {% endif %}
                                            {% if litigant.bail %}
                                                <td class="text-center"><b>√</b></td>
                                            {% endif %}
                                            {% if litigant.distrained %}
                                                <td class="text-center"><b>√</b></td>
                                            {% endif %}
                                            </tr>
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.amercement.all %}
                                    <table class="table table-bordered" id="amercements_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center">Amercement</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for amercement in litigant.amercements.all %}
                                                <tr>
                                                    <td>{{ amercement.amercement }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.capitagia.all %}
                                    <table class="table table-bordered" id="capitagia_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="6">Capitagium</th>
                                            </tr>
                                            <th>Assessment</th>
                                            <th>Crossed</th>
                                            <th>Recessit</th>
                                            <th>Habet Terram</th>
                                            <th>Mortuus</th>
                                            <th>Notes</th>
                                        </thead>
                                        <tbody>
                                            {% for cap in litigant.capitagia.all %}
                                                <tr>
                                                    <td>{{ cap.capitagium }}</td>
                                                    <td class="text-center">{% if cap.crossed %}<b>√</b>{% endif %}</td>
                                                    <td class="text-center">{% if cap.recessit %}<b>√</b>{% endif %}</td>
                                                    <td class="text-center">{% if cap.habet_terram %}<b>√</b>{% endif %}</td>
                                                    <td class="text-center">{% if cap.mortuus %}<b>√</b>{% endif %}</td>
                                                    <td>{{ cap.notes|linebreaks }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.damages.all %}
                                    <table class="table table-bordered" id="damages_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="2">Damages</th>
                                            </tr>
                                            <th>Assessment</th>
                                            <th>Notes</th>
                                        </thead>
                                        <tbody>
                                            {% for damage in litigant.damages.all %}
                                                <tr>
                                                    <td>{{ damage.damage|linebreaks }}</td>
                                                    <td>{{ damage.notes }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.fines.all %}
                                    <table class="table table-bordered" id="fines_table">
                                        <thead>
                                            <th class="text-center">Fine</th>
                                        </thead>
                                        <tbody>
                                            {% for fine in litigant.fines.all %}
                                                <tr>
                                                    <td>{{ fine.fine }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.heriots.all %}
                                    <table class="table table-bordered" id="heriot_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="2">Heriot</th>
                                            </tr>
                                            <th>Chattel</th>
                                            <th>Assessment</th>
                                        </thead>
                                        <tbody>
                                            {% for heriot in litigant.heriots.all %}
                                                <tr>
                                                    <td>{{ heriot.quantity }} {{ heriot.animal }}</td>
                                                    <td>{{ heriot.heriot }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.impercamenta.all %}
                                    <table class="table table-bordered" id="impercamenta_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="3">Impercamentum</th>
                                            </tr>
                                            <th>Chattel</th>
                                            <th>Assessment</th>
                                            <th>Notes</th>
                                        </thead>
                                        <tbody>
                                            {% for imperc in litigant.impercamenta.all %}
                                            <tr>
                                                <td>{{ imperc.quantity }} {{ imperc.animal }}</td>
                                                <td>{{ imperc.impercamentum }}</td>
                                                <td>{{ imperc.notes|linebreaks }}</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.lands.all %}
                                    <table class="table table-bordered" id="lands_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="5">Land</th>
                                            </tr>
                                            <th>ID</th>
                                            <th>Land Role</th>
                                            <th>Parcels</th>
                                            <th>Villein</th>
                                            <th>Notes</th>
                                        </thead>
                                        <tbody>
                                            {% for land in litigant.lands.all %}
                                                <tr>
                                                    <td><a href="{% url 'land:detail' land.land.id %}">{{ land.land.id }}</a></td>
                                                    <td>{{ land.role.role }}</td>
                                                    <td>
                                                        <ul class="list-group">
                                                            {% for parcel in land.land.parcels.all %}
                                                                <li class="list-group-item">{{ parcel.amount }} {{ parcel.parcel_type.parcel_type }} of {{ parcel.parcel_tenure.tenure }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                    </td>
                                                    <td class="text-center">{% if land.villeinage %}<b>√</b>{% endif %}</td>
                                                    <td>{{ land.notes|linebreaks }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                                {% if litigant.pledges.all %}
                                    <table class="table table-bordered" id="pledges_table">
                                        <thead>
                                            <tr>
                                                <th colspan="4" class="text-center">Pledges</th>
                                            </tr>
                                            <tr>
                                            <th>Name</th>
                                            <th>Status</th>
                                            <th>Gender</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for pledge in litigant.pledges.all %}
                                                <tr>
                                                    <td><a href="{% url 'person:detail' pledge.giver.id %}">{{ pledge.giver.full_name }}</a></td>
                                                    <td>{{ pledge.giver.get_status_display }}</td>
                                                    <td>{{ pledge.giver.get_gender_display }}</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}

                            </div>
                        </div>
                    </div>
            {% endfor %}
        </div>
    </div>
{% endif %}
